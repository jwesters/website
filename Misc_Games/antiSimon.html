<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Anti-Simon (Click ANY other color)</title>
  <style>
    :root{
      --bg:#0f1220;
      --panel:#151a2e;
      --text:#e9ecff;
      --muted:#aab1da;
      --good:#2ee59d;
      --bad:#ff4d6d;
      --ring:#0b0e19;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: radial-gradient(1200px 800px at 30% 20%, #1a2250 0%, var(--bg) 55%, #070912 100%);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    .wrap{
      width:min(980px, 94vw);
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:22px;
      align-items:stretch;
    }
    @media (max-width: 860px){
      .wrap{ grid-template-columns: 1fr; }
    }

    .card{
      background: color-mix(in srgb, var(--panel) 92%, black 8%);
      border: 1px solid rgba(255,255,255,.08);
      border-radius:16px;
      box-shadow: 0 18px 50px rgba(0,0,0,.35);
      padding:18px;
    }

    /* Board */
    .boardBox{
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:center;
      justify-content:center;
    }

    .board{
      position:relative;
      width:min(420px, 78vw);
      aspect-ratio:1/1;
      border-radius:50%;
      overflow:hidden;
      background: #000;
      border: 10px solid rgba(255,255,255,.06);
      box-shadow:
        inset 0 0 0 6px rgba(0,0,0,.35),
        0 18px 45px rgba(0,0,0,.40);
      user-select:none;
      touch-action: manipulation;
    }

    .quad{
      position:absolute;
      width:50%;
      height:50%;
      cursor:pointer;
      opacity:.95;
      transition: filter 120ms ease, transform 120ms ease, opacity 120ms ease;
      outline:none;
    }
    .quad:active{ transform: scale(0.985); }

    /* Quadrants */
    .red{ left:0; top:0; background:#e53935; border-right:6px solid rgba(0,0,0,.25); border-bottom:6px solid rgba(0,0,0,.25); }
    .green{ right:0; top:0; background:#43a047; border-left:6px solid rgba(0,0,0,.25); border-bottom:6px solid rgba(0,0,0,.25); }
    .yellow{ left:0; bottom:0; background:#f6c026; border-right:6px solid rgba(0,0,0,.25); border-top:6px solid rgba(0,0,0,.25); }
    .blue{ right:0; bottom:0; background:#1e88e5; border-left:6px solid rgba(0,0,0,.25); border-top:6px solid rgba(0,0,0,.25); }

    .center{
      position:absolute;
      inset: 50%;
      transform: translate(-50%, -50%);
      width:44%;
      height:44%;
      border-radius:50%;
      background: radial-gradient(circle at 35% 25%, #2a3160 0%, #121736 45%, #0a0d20 100%);
      border: 10px solid rgba(0,0,0,.38);
      box-shadow:
        0 10px 30px rgba(0,0,0,.45),
        inset 0 0 0 2px rgba(255,255,255,.08);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding:10px;
      gap:6px;
      pointer-events:none;
    }

    .title{
      font-weight:800;
      letter-spacing:.5px;
      font-size:14px;
      opacity:.95;
    }
    .rule{
      font-size:12px;
      color:var(--muted);
      line-height:1.2;
    }

    .flash{
      filter: brightness(1.45) saturate(1.2);
      opacity: 1;
    }
    .disabled{
      cursor:not-allowed;
      opacity:.6;
    }

    /* Right panel */
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .stat{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .pill{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius:999px;
      padding:8px 12px;
      font-size:13px;
      display:flex;
      gap:8px;
      align-items:baseline;
    }
    .pill b{ font-size:14px; }

    .btns{ display:flex; gap:10px; flex-wrap:wrap; }
    button{
      appearance:none;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      font-weight:700;
      cursor:pointer;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
    }
    button:hover{
      background: rgba(255,255,255,.12);
      border-color: rgba(255,255,255,.22);
    }
    button:active{ transform: translateY(1px); }
    button.primary{
      background: rgba(46,229,157,.18);
      border-color: rgba(46,229,157,.35);
    }
    button.danger{
      background: rgba(255,77,109,.14);
      border-color: rgba(255,77,109,.35);
    }

    .status{
      margin-top:10px;
      padding:12px;
      border-radius:12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      min-height:44px;
      font-size:14px;
      line-height:1.25;
    }
    .status.good{ border-color: rgba(46,229,157,.35); }
    .status.bad{ border-color: rgba(255,77,109,.35); }

    .hsTitle{
      margin:14px 0 8px;
      font-weight:800;
      letter-spacing:.2px;
      opacity:.95;
    }
    .hsList{
      list-style:none;
      padding:0;
      margin:0;
      border: 1px solid rgba(255,255,255,.10);
      border-radius:12px;
      overflow:hidden;
      background: rgba(0,0,0,.18);
    }
    .hsList li{
      display:flex;
      justify-content:space-between;
      padding:10px 12px;
      border-top: 1px solid rgba(255,255,255,.08);
      font-size:14px;
    }
    .hsList li:first-child{ border-top:none; }
    .hsList .rank{
      opacity:.7;
      width:28px;
      display:inline-block;
    }
    .hsList .date{
      opacity:.65;
      font-size:12px;
      margin-left:10px;
      white-space:nowrap;
    }

    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      padding:2px 6px;
      border-radius:7px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
    }

    .footerHint{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.25;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card boardBox" aria-label="Game board">
      <div class="board" id="board" role="application" aria-label="Anti-Simon board">
        <button class="quad red"    data-color="red"    aria-label="Red"></button>
        <button class="quad green"  data-color="green"  aria-label="Green"></button>
        <button class="quad yellow" data-color="yellow" aria-label="Yellow"></button>
        <button class="quad blue"   data-color="blue"   aria-label="Blue"></button>

        <div class="center" aria-hidden="true">
          <div class="title">ANTI-SIMON</div>
          <div class="rule">Click <b>any</b> color<br/>except the one that flashes.</div>
        </div>
      </div>
      <div class="footerHint">
        Tip: You can play with mouse or touch. Use <span class="kbd">Enter</span> to start, <span class="kbd">R</span> to reset highscores.
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div class="stat">
          <div class="pill">Correct: <b id="correctNow">0</b></div>
          <div class="pill">Best: <b id="bestNow">0</b></div>
        </div>
        <div class="btns">
          <button class="primary" id="startBtn">Start</button>
          <button id="restartBtn">Restart Round</button>
          <button class="danger" id="clearBtn" title="Clears local high scores">Clear High Scores</button>
        </div>
      </div>

      <div id="status" class="status">
        Press <b>Start</b>. Watch the flash, then click any OTHER color to score.
      </div>

      <div class="hsTitle">High Scores (local)</div>
      <ol id="hsList" class="hsList"></ol>
    </div>
  </div>

  <script>
    (() => {
      const COLORS = ["red", "green", "blue", "yellow"];
      const FLASH_MS = 520;
      const BETWEEN_MS = 180;

      const board = document.getElementById("board");
      const pads = Array.from(document.querySelectorAll(".quad"));
      const statusEl = document.getElementById("status");
      const correctEl = document.getElementById("correctNow");
      const bestEl = document.getElementById("bestNow");

      const startBtn = document.getElementById("startBtn");
      const restartBtn = document.getElementById("restartBtn");
      const clearBtn = document.getElementById("clearBtn");

      const hsListEl = document.getElementById("hsList");

      const STORAGE_KEY = "anti_simon_highscores_v1";
      const MAX_SCORES = 10;

      let playing = false;
      let acceptingInput = false;
      let forbiddenColor = null;
      let correct = 0;

      function nowStamp(){
        const d = new Date();
        const yyyy = d.getFullYear();
        const mm = String(d.getMonth()+1).padStart(2,"0");
        const dd = String(d.getDate()).padStart(2,"0");
        const hh = String(d.getHours()).padStart(2,"0");
        const mi = String(d.getMinutes()).padStart(2,"0");
        return `${yyyy}-${mm}-${dd} ${hh}:${mi}`;
      }

      function getScores(){
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          const arr = raw ? JSON.parse(raw) : [];
          return Array.isArray(arr) ? arr : [];
        }catch{
          return [];
        }
      }

      function saveScores(arr){
        localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
      }

      function bestScore(){
        const arr = getScores();
        return arr.length ? Math.max(...arr.map(s => s.score)) : 0;
      }

      function renderScores(){
        const arr = getScores()
          .slice()
          .sort((a,b) => b.score - a.score)
          .slice(0, MAX_SCORES);

        hsListEl.innerHTML = "";
        if(arr.length === 0){
          const li = document.createElement("li");
          li.innerHTML = `<span><span class="rank">—</span>No scores yet</span><span class="date"></span>`;
          hsListEl.appendChild(li);
        }else{
          arr.forEach((s, idx) => {
            const li = document.createElement("li");
            li.innerHTML = `
              <span><span class="rank">${idx+1}.</span> ${s.score}</span>
              <span class="date">${s.when}</span>
            `;
            hsListEl.appendChild(li);
          });
        }

        bestEl.textContent = String(bestScore());
      }

      function setStatus(msg, kind){
        statusEl.classList.remove("good","bad");
        if(kind) statusEl.classList.add(kind);
        statusEl.innerHTML = msg;
      }

      function setPadsEnabled(on){
        pads.forEach(p => {
          p.disabled = !on;
          p.classList.toggle("disabled", !on);
        });
      }

      function sleep(ms){
        return new Promise(res => setTimeout(res, ms));
      }

      function pickForbidden(){
        return COLORS[Math.floor(Math.random() * COLORS.length)];
      }

      function padByColor(color){
        return pads.find(p => p.dataset.color === color);
      }

      async function flashColor(color){
        const pad = padByColor(color);
        if(!pad) return;
        pad.classList.add("flash");
        await sleep(FLASH_MS);
        pad.classList.remove("flash");
      }

      async function nextPrompt(){
        acceptingInput = false;
        setPadsEnabled(false);

        forbiddenColor = pickForbidden();
        setStatus(`Watch… <b>${forbiddenColor.toUpperCase()}</b> is the “NO” color this turn. Click any other color.`, null);

        await sleep(200);
        await flashColor(forbiddenColor);
        await sleep(BETWEEN_MS);

        acceptingInput = true;
        setPadsEnabled(true);
        setStatus(`Now click <b>ANY</b> color except <b>${forbiddenColor.toUpperCase()}</b>.`, null);
      }

      function endRound(reason){
        playing = false;
        acceptingInput = false;
        setPadsEnabled(false);

        // Save score if > 0
        if(correct > 0){
          const arr = getScores();
          arr.push({ score: correct, when: nowStamp() });
          // keep only top-ish set (store a bit more, then slice at render)
          arr.sort((a,b) => b.score - a.score);
          saveScores(arr.slice(0, Math.max(MAX_SCORES * 3, 30)));
        }

        renderScores();

        setStatus(
          `<b>Game over.</b> ${reason}<br/>You got <b>${correct}</b> correct. Press <b>Start</b> to play again.`,
          "bad"
        );
      }

      function startRound(){
        correct = 0;
        correctEl.textContent = "0";
        playing = true;
        setPadsEnabled(false);
        setStatus("Get ready…", null);
        nextPrompt();
      }

      function handlePick(color){
        if(!playing || !acceptingInput) return;

        // Immediate feedback flash on the clicked pad
        const pad = padByColor(color);
        if(pad){
          pad.classList.add("flash");
          setTimeout(() => pad.classList.remove("flash"), 140);
        }

        if(color === forbiddenColor){
          endRound(`You clicked the forbidden color <b>${forbiddenColor.toUpperCase()}</b>.`);
          return;
        }

        // Correct
        correct += 1;
        correctEl.textContent = String(correct);
        setStatus(`✅ Nice. <b>${forbiddenColor.toUpperCase()}</b> was avoided. Score: <b>${correct}</b>.`, "good");

        // next
        nextPrompt();
      }

      // Event wiring
      pads.forEach(p => {
        p.addEventListener("click", () => handlePick(p.dataset.color));
      });

      startBtn.addEventListener("click", () => startRound());

      restartBtn.addEventListener("click", () => {
        if(!playing){
          startRound();
        }else{
          // Restart just resets current round score
          startRound();
        }
      });

      clearBtn.addEventListener("click", () => {
        localStorage.removeItem(STORAGE_KEY);
        renderScores();
        setStatus("High scores cleared (local). Press <b>Start</b> to play.", null);
      });

      // Keyboard helpers
      window.addEventListener("keydown", (e) => {
        if(e.key === "Enter"){
          e.preventDefault();
          startRound();
        }
        if(e.key.toLowerCase() === "r"){
          // reset highscores
          localStorage.removeItem(STORAGE_KEY);
          renderScores();
          setStatus("High scores cleared (local). Press <b>Start</b> to play.", null);
        }
      });

      // Init
      setPadsEnabled(false);
      renderScores();
      bestEl.textContent = String(bestScore());
    })();
  </script>
</body>
</html>
